<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Laser Chase Game</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      font-family: sans-serif;
    }

    #gameArea {
      position: relative;
      width: 100vw;
      height: 100vh;
      background-color: #f0f0f0;
      overflow: hidden;
    }

    .block {
      position: absolute;
      width: 50px;
      height: 50px;
    }

    #player {
      z-index: 2;
    }

    .chaser {
      background-color: red;
      z-index: 1;
    }

    .laser {
      position: absolute;
      width: 10px;
      height: 10px;
      background-color: green;
      z-index: 3;
    }

    #shield {
      position: absolute;
      width: 60px;
      height: 6px;
      background-color: rgba(0, 0, 255, 0.6);
      z-index: 1;
      pointer-events: none;
      transform-origin: center;
    }

    #gameOver {
      position: absolute;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: rgba(0,0,0,0.8);
      color: white;
      font-size: 32px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 10;
      display: none;
    }

    #retryBtn {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 20px;
      cursor: pointer;
    }

    #skinChooser {
      position: absolute;
      top: 30%;
      left: 50%;
      transform: translate(-50%, -30%);
      background: white;
      padding: 20px;
      border: 2px solid #ccc;
      z-index: 11;
      text-align: center;
    }

    #skinChooser button {
      margin: 5px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }

    #timer {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 24px;
      font-weight: bold;
      z-index: 5;
    }
  </style>
</head>
<body>
  <div id="gameArea">
    <div id="skinChooser">
      <h3>Choose Your Skin</h3>
      <button onclick="selectSkin('blue')">Blue</button>
      <button onclick="selectSkin('green')">Green</button>
      <button onclick="selectSkin('purple')">Purple</button>
    </div>
    <div id="timer">Time: 0s</div>
    <div id="player" class="block"></div>
    <div id="shield"></div>
    <div id="gameOver"></div>
  </div>
<script>
  const gameArea = document.getElementById("gameArea");
  const player = document.getElementById("player");
  const shield = document.getElementById("shield");
  const gameOver = document.getElementById("gameOver");
  const skinChooser = document.getElementById("skinChooser");
  const timerDisplay = document.getElementById("timer");

  let username = prompt("Enter your username:");
  let startTime;
  let leaderboard = JSON.parse(localStorage.getItem("leaderboard")) || [];

  let playerX = 100, playerY = 100;
  let mouseX = 0, mouseY = 0;
  const playerSpeed = 3;
  const keys = { ArrowUp: false, ArrowDown: false, ArrowLeft: false, ArrowRight: false };
  const chasers = [];
  const lasers = [];
  let gameRunning = false;

  let lastTeleportTime = 0;
  const teleportCooldown = 10000;

  document.addEventListener("keydown", e => {
    if (keys.hasOwnProperty(e.key)) keys[e.key] = true;
  });
  document.addEventListener("keyup", e => {
    if (keys.hasOwnProperty(e.key)) keys[e.key] = false;
  });
  document.addEventListener("mousemove", e => {
    mouseX = e.clientX;
    mouseY = e.clientY;
  });
  gameArea.addEventListener("click", e => {
    if (!gameRunning) return;
    const now = Date.now();
    if (now - lastTeleportTime >= teleportCooldown) {
      playerX = e.clientX - 25;
      playerY = e.clientY - 25;
      lastTeleportTime = now;
    }
  });

  function selectSkin(color) {
    player.style.backgroundColor = color;
    skinChooser.style.display = "none";
    startGame();
  }

  function startGame() {
    gameRunning = true;
    startTime = Date.now();
    updatePlayer();
    gameLoop();
    spawnChaser();
    setInterval(spawnChaser, 2000);
    setInterval(updateTimer, 1000);
  }

  function updateTimer() {
    if (!gameRunning) return;
    const elapsed = Math.floor((Date.now() - startTime) / 1000);
    timerDisplay.textContent = `Time: ${elapsed}s`;
  }

  function movePlayer() {
    if (!gameRunning) return;
    const maxX = window.innerWidth - 50;
    const maxY = window.innerHeight - 50;
    if (keys.ArrowUp && playerY > 0) playerY -= playerSpeed;
    if (keys.ArrowDown && playerY < maxY) playerY += playerSpeed;
    if (keys.ArrowLeft && playerX > 0) playerX -= playerSpeed;
    if (keys.ArrowRight && playerX < maxX) playerX += playerSpeed;
  }

  function updatePlayer() {
    player.style.left = playerX + "px";
    player.style.top = playerY + "px";
  }

  function updateShield() {
    const angle = Math.atan2(mouseY - (playerY + 25), mouseX - (playerX + 25));
    const distance = 40;
    const shieldX = playerX + 25 + Math.cos(angle) * distance - 30;
    const shieldY = playerY + 25 + Math.sin(angle) * distance - 3;
    shield.style.left = shieldX + "px";
    shield.style.top = shieldY + "px";
    shield.style.transform = `rotate(${angle}rad)`;
  }

  function spawnChaser() {
    const chaser = document.createElement("div");
    chaser.classList.add("block", "chaser");
    chaser.style.left = Math.random() * (window.innerWidth - 50) + "px";
    chaser.style.top = Math.random() * (window.innerHeight - 50) + "px";
    gameArea.appendChild(chaser);
    const chaserObj = {
      el: chaser,
      x: parseInt(chaser.style.left),
      y: parseInt(chaser.style.top),
      active: true
    };
    chasers.push(chaserObj);
    setTimeout(() => fireLaser(chaserObj), 1000);
  }

  function fireLaser(chaser) {
    if (!gameRunning || !chaser.active) return;
    const laser = document.createElement("div");
    laser.classList.add("laser");
    laser.style.left = chaser.x + 20 + "px";
    laser.style.top = chaser.y + 20 + "px";
    gameArea.appendChild(laser);
    const dx = playerX - chaser.x;
    const dy = playerY - chaser.y;
    const dist = Math.sqrt(dx * dx + dy * dy);
    const vx = (dx / dist) * 5;
    const vy = (dy / dist) * 5;
    lasers.push({ el: laser, x: chaser.x + 20, y: chaser.y + 20, vx, vy });
  }

  function moveLasers() {
    lasers.forEach((laser, index) => {
      laser.x += laser.vx;
      laser.y += laser.vy;
      laser.el.style.left = laser.x + "px";
      laser.el.style.top = laser.y + "px";
      if (
        laser.x > playerX &&
        laser.x < playerX + 50 &&
        laser.y > playerY &&
        laser.y < playerY + 50
      ) endGame();
      if (
        laser.x < 0 || laser.x > window.innerWidth ||
        laser.y < 0 || laser.y > window.innerHeight
      ) {
        laser.el.remove();
        lasers.splice(index, 1);
      }
    });
  }

  function moveChasers() {
    chasers.forEach(chaser => {
      if (!chaser.active || !gameRunning) return;
      const dx = playerX - chaser.x;
      const dy =
